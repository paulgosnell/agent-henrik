<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../">
    <title>Leads - Luxury Travel Sweden CMS</title>
    <link rel="stylesheet" href="admin/admin.css">

    <!-- Component Loader -->
    <script src="admin/admin-component-loader.js?v=3"></script>
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-spinner"></div>
        <p>Loading leads...</p>
    </div>

    <!-- Main Container -->
    <div id="adminApp" class="admin-container" style="display: none;">

        <!-- Sidebar Navigation - Loaded from component -->


        <div id="sidebar-placeholder"></div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="content-header">
                <div class="header-left">
                    <h1>Leads & Contacts</h1>
                    <p class="subtitle">Manage all inquiries from LIV AI, contact forms, and newsletter signups</p>
                </div>
                <div class="header-right">
                    <button id="exportLeads" class="btn-secondary">
                        <svg width="18" height="18" viewBox="0 0 20 20" fill="none">
                            <path d="M10 14V3M10 3L6 7M10 3L14 7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            <path d="M3 14V17C3 18.1046 3.89543 19 5 19H15C16.1046 19 17 18.1046 17 17V14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                        Export CSV
                    </button>
                </div>
            </header>

            <!-- Filter Tabs -->
            <div class="filter-tabs">
                <button class="filter-tab active" data-status="all">All (<span id="countAll">0</span>)</button>
                <button class="filter-tab" data-status="new">New (<span id="countNew">0</span>)</button>
                <button class="filter-tab" data-status="contacted">Contacted (<span id="countContacted">0</span>)</button>
                <button class="filter-tab" data-status="qualified">Qualified (<span id="countQualified">0</span>)</button>
                <button class="filter-tab" data-status="converted">Converted (<span id="countConverted">0</span>)</button>
            </div>

            <!-- Leads Table -->
            <div class="content-card">
                <div id="leadsTableContainer">
                    <div class="skeleton-loader" style="height: 400px;"></div>
                </div>
            </div>
        </main>
    </div>

    <!-- Lead Detail Modal -->
    <div id="leadModal" class="modal">
        <div class="modal-content modal-large">
            <button class="modal-close" id="closeLeadModal">&times;</button>
            <h2>Lead Details</h2>
            <div id="leadDetailContent"></div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="supabase-client.js?v=2"></script>
    <script src="admin/auth.js"></script>
    <script src="leads.js"></script>

    <!-- Auth Protection -->
    <script>
        (async function() {
            const user = await window.AuthManager.requireAuth();
            if (user) {
                await window.AuthManager.updateUserInfoUI();
            }
        })();
    </script>
</body>
</html>
