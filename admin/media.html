<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Library - Luxury Travel Sweden CMS</title>
    <link rel="stylesheet" href="admin.css">
    <style>
        /* ==========================================
           MEDIA LIBRARY SPECIFIC STYLES
           ========================================== */

        /* Upload Zone */
        .upload-section {
            margin-bottom: 2.5rem;
        }

        .upload-zone {
            border: 2px dashed var(--admin-border);
            border-radius: 12px;
            padding: 3rem 2rem;
            text-align: center;
            background: var(--admin-surface);
            transition: var(--transition);
            cursor: pointer;
            position: relative;
        }

        .upload-zone.drag-over {
            border-color: var(--admin-accent);
            background: rgba(74, 158, 255, 0.05);
            transform: scale(1.01);
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.6;
        }

        .upload-zone h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--admin-text);
            margin-bottom: 0.5rem;
        }

        .upload-zone p {
            color: var(--admin-text-secondary);
            margin-bottom: 1rem;
        }

        .upload-hint {
            font-size: 0.875rem;
            color: var(--admin-text-muted);
            margin-top: 1rem;
        }

        /* Upload Progress */
        .upload-progress {
            margin-top: 1.5rem;
            display: none;
        }

        .upload-progress.active {
            display: block;
        }

        .upload-item {
            background: var(--admin-surface-elevated);
            border: 1px solid var(--admin-border);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .upload-item-preview {
            width: 60px;
            height: 60px;
            border-radius: 6px;
            object-fit: cover;
            background: var(--admin-surface);
            flex-shrink: 0;
        }

        .upload-item-info {
            flex: 1;
            min-width: 0;
        }

        .upload-item-name {
            font-size: 0.9375rem;
            font-weight: 500;
            color: var(--admin-text);
            margin-bottom: 0.25rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .upload-item-status {
            font-size: 0.8125rem;
            color: var(--admin-text-muted);
        }

        .upload-item-status.success {
            color: var(--admin-success);
        }

        .upload-item-status.error {
            color: var(--admin-danger);
        }

        .progress-bar {
            height: 6px;
            background: var(--admin-surface);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: var(--admin-accent);
            transition: width 0.3s ease;
            border-radius: 3px;
        }

        /* Toolbar */
        .media-toolbar {
            display: flex;
            gap: 1rem;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .media-toolbar-left {
            flex: 1;
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .media-toolbar-right {
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }

        .media-count {
            color: var(--admin-text-secondary);
            font-size: 0.9375rem;
        }

        .media-count strong {
            color: var(--admin-text);
        }

        /* Search and Sort */
        .search-input {
            flex: 1;
            max-width: 400px;
            padding: 0.75rem 1rem 0.75rem 2.75rem;
            background: var(--admin-surface);
            border: 1px solid var(--admin-border);
            border-radius: 8px;
            color: var(--admin-text);
            font-size: 0.9375rem;
            transition: var(--transition);
            position: relative;
        }

        .search-wrapper {
            position: relative;
            flex: 1;
            max-width: 400px;
        }

        .search-wrapper::before {
            content: 'üîç';
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1rem;
            opacity: 0.6;
            pointer-events: none;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--admin-accent);
            box-shadow: 0 0 0 3px rgba(74, 158, 255, 0.1);
        }

        .sort-select {
            padding: 0.75rem 2.5rem 0.75rem 1rem;
            background: var(--admin-surface);
            border: 1px solid var(--admin-border);
            border-radius: 8px;
            color: var(--admin-text);
            font-size: 0.9375rem;
            cursor: pointer;
            transition: var(--transition);
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1.5L6 6.5L11 1.5' stroke='%239aa0a6' stroke-width='2' stroke-linecap='round'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
        }

        .sort-select:focus {
            outline: none;
            border-color: var(--admin-accent);
            box-shadow: 0 0 0 3px rgba(74, 158, 255, 0.1);
        }

        /* Media Grid */
        .media-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .media-item {
            background: var(--admin-surface);
            border: 1px solid var(--admin-border);
            border-radius: 12px;
            overflow: hidden;
            transition: var(--transition);
            cursor: pointer;
        }

        .media-item:hover {
            border-color: var(--admin-border-strong);
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
        }

        .media-thumbnail {
            width: 100%;
            height: 200px;
            position: relative;
            background: var(--admin-surface-elevated);
            overflow: hidden;
        }

        .media-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .media-item:hover .media-thumbnail img {
            transform: scale(1.05);
        }

        .media-info {
            padding: 1rem;
        }

        .media-filename {
            font-size: 0.9375rem;
            font-weight: 500;
            color: var(--admin-text);
            margin-bottom: 0.5rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .media-meta {
            font-size: 0.8125rem;
            color: var(--admin-text-muted);
            margin-bottom: 0.75rem;
        }

        .media-actions {
            display: flex;
            gap: 0.5rem;
            padding-top: 0.75rem;
            border-top: 1px solid var(--admin-border);
        }

        .btn-icon {
            flex: 1;
            padding: 0.5rem;
            background: transparent;
            border: 1px solid var(--admin-border);
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
            color: var(--admin-text-muted);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-icon:hover {
            background: var(--admin-surface-elevated);
            color: var(--admin-text);
            border-color: var(--admin-border-strong);
        }

        .btn-icon.btn-danger:hover {
            color: var(--admin-danger);
            border-color: var(--admin-danger);
            background: rgba(255, 107, 107, 0.1);
        }

        /* Preview Modal */
        .preview-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            overflow-y: auto;
        }

        .preview-modal.active {
            display: flex;
        }

        .preview-content {
            background: var(--admin-surface);
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
            width: 100%;
            max-width: 900px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            animation: modalSlideIn 0.3s ease;
        }

        .preview-header {
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--admin-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .preview-header h2 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--admin-text);
        }

        .preview-close {
            width: 36px;
            height: 36px;
            background: transparent;
            border: none;
            font-size: 1.5rem;
            color: var(--admin-text-muted);
            cursor: pointer;
            border-radius: 8px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .preview-close:hover {
            background: var(--admin-surface-elevated);
            color: var(--admin-text);
        }

        .preview-body {
            padding: 2rem;
            overflow-y: auto;
            flex: 1;
        }

        .preview-image-container {
            text-align: center;
            margin-bottom: 2rem;
            background: var(--admin-surface-elevated);
            border-radius: 12px;
            padding: 1rem;
        }

        .preview-image {
            max-width: 100%;
            max-height: 400px;
            border-radius: 8px;
            box-shadow: var(--shadow-md);
        }

        .preview-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .preview-detail {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .preview-detail.full-width {
            grid-column: 1 / -1;
        }

        .preview-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--admin-text-secondary);
        }

        .preview-value {
            font-size: 0.9375rem;
            color: var(--admin-text);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .copy-url-btn {
            padding: 0.5rem 1rem;
            background: var(--admin-accent);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .copy-url-btn:hover {
            background: var(--admin-accent-hover);
            transform: translateY(-1px);
        }

        .url-display {
            padding: 0.75rem 1rem;
            background: var(--admin-surface-elevated);
            border: 1px solid var(--admin-border);
            border-radius: 6px;
            font-size: 0.875rem;
            color: var(--admin-text-secondary);
            font-family: 'Monaco', 'Courier New', monospace;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .preview-footer {
            padding: 1.5rem 2rem;
            border-top: 1px solid var(--admin-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .preview-edit-fields {
            display: grid;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .edit-field {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .edit-field label {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--admin-text);
        }

        .edit-field input,
        .edit-field textarea {
            padding: 0.75rem 1rem;
            background: var(--admin-surface-elevated);
            border: 1px solid var(--admin-border);
            border-radius: 8px;
            color: var(--admin-text);
            font-size: 0.9375rem;
            font-family: inherit;
            transition: var(--transition);
        }

        .edit-field textarea {
            min-height: 80px;
            resize: vertical;
        }

        .edit-field input:focus,
        .edit-field textarea:focus {
            outline: none;
            border-color: var(--admin-accent);
            box-shadow: 0 0 0 3px rgba(74, 158, 255, 0.1);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--admin-text-muted);
        }

        .empty-state-icon {
            font-size: 4rem;
            opacity: 0.3;
            margin-bottom: 1rem;
        }

        .empty-state h3 {
            font-size: 1.25rem;
            color: var(--admin-text);
            margin-bottom: 0.5rem;
        }

        .empty-state p {
            font-size: 0.9375rem;
            margin-bottom: 1.5rem;
        }

        /* Setup Required Banner */
        .setup-banner {
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.15), rgba(255, 152, 0, 0.15));
            border: 2px solid rgba(255, 193, 7, 0.5);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            display: none;
        }

        .setup-banner.show {
            display: block;
        }

        .setup-banner-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .setup-banner-icon {
            font-size: 2.5rem;
        }

        .setup-banner-title {
            flex: 1;
        }

        .setup-banner-title h3 {
            font-size: 1.5rem;
            color: var(--admin-text);
            margin-bottom: 0.25rem;
        }

        .setup-banner-title p {
            font-size: 0.95rem;
            color: var(--admin-text-secondary);
            margin: 0;
        }

        .setup-checklist {
            background: var(--admin-surface);
            border: 1px solid var(--admin-border);
            border-radius: 8px;
            overflow: hidden;
        }

        .setup-item {
            padding: 1.25rem;
            border-bottom: 1px solid var(--admin-border);
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .setup-item:last-child {
            border-bottom: none;
        }

        .setup-item-status {
            font-size: 1.5rem;
            flex-shrink: 0;
            margin-top: 0.25rem;
        }

        .setup-item-status.checking {
            animation: pulse 1.5s ease-in-out infinite;
        }

        .setup-item-status.success {
            color: var(--admin-success);
        }

        .setup-item-status.error {
            color: var(--admin-danger);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .setup-item-content {
            flex: 1;
        }

        .setup-item-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--admin-text);
            margin-bottom: 0.5rem;
        }

        .setup-item-description {
            font-size: 0.9rem;
            color: var(--admin-text-secondary);
            margin-bottom: 0.75rem;
            line-height: 1.5;
        }

        .setup-instructions {
            background: var(--admin-surface-elevated);
            border: 1px solid var(--admin-border);
            border-radius: 6px;
            padding: 1rem;
            font-size: 0.875rem;
            color: var(--admin-text);
            margin-top: 0.75rem;
        }

        .setup-instructions-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--admin-accent);
        }

        .setup-instructions ol {
            margin: 0.5rem 0 0 1.25rem;
            padding: 0;
        }

        .setup-instructions li {
            margin-bottom: 0.5rem;
            line-height: 1.6;
        }

        .setup-instructions code {
            background: rgba(0, 0, 0, 0.2);
            padding: 0.125rem 0.375rem;
            border-radius: 3px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.85em;
        }

        .setup-sql {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1rem;
            border-radius: 6px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.8rem;
            overflow-x: auto;
            margin-top: 0.75rem;
            max-height: 300px;
            overflow-y: auto;
        }

        .btn-copy-sql {
            margin-top: 0.75rem;
            padding: 0.5rem 1rem;
            background: var(--admin-accent);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: var(--transition);
        }

        .btn-copy-sql:hover {
            background: var(--admin-accent-hover);
        }

        .btn-refresh-check {
            margin-top: 1rem;
            padding: 0.75rem 1.5rem;
            background: var(--admin-accent);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            transition: var(--transition);
        }

        .btn-refresh-check:hover {
            background: var(--admin-accent-hover);
            transform: translateY(-1px);
        }

        /* Loading State */
        .media-loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 4rem 2rem;
        }

        /* Notification Toast */
        .notification-toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--admin-surface-elevated);
            border: 1px solid var(--admin-border);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            z-index: 3000;
            animation: slideInUp 0.3s ease;
            max-width: 400px;
        }

        .notification-toast.success {
            border-color: var(--admin-success);
            background: rgba(61, 214, 140, 0.1);
        }

        .notification-toast.error {
            border-color: var(--admin-danger);
            background: rgba(255, 107, 107, 0.1);
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .notification-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .notification-message {
            flex: 1;
            font-size: 0.9375rem;
            color: var(--admin-text);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .media-grid {
                grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
                gap: 1rem;
            }

            .media-toolbar {
                flex-direction: column;
                align-items: stretch;
            }

            .media-toolbar-left,
            .search-wrapper {
                max-width: 100%;
            }

            .preview-details {
                grid-template-columns: 1fr;
            }

            .upload-zone {
                padding: 2rem 1rem;
            }
        }

        @media (max-width: 480px) {
            .media-grid {
                grid-template-columns: 1fr;
            }

            .notification-toast {
                bottom: 1rem;
                right: 1rem;
                left: 1rem;
                max-width: none;
            }
        }
    </style>

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-spinner"></div>
        <p>Loading media library...</p>
    </div>

    <!-- Main Container -->
    <div id="adminApp" class="admin-container" style="display: none;">

        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <path d="M16 2L26 8L26 24L16 30L6 24L6 8L16 2Z" fill="currentColor" opacity="0.2"/>
                        <path d="M16 2L26 8M26 8L26 24M26 24L16 30M16 30L6 24M6 24L6 8M6 8L16 2M16 2L16 30M6 8L26 24M26 8L6 24" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                    <div>
                        <h1>LTS</h1>
                        <span>CMS</span>
                    </div>
                </div>
            </div>

            <nav class="sidebar-nav">
                <a href="index.html" class="nav-item">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <rect x="3" y="3" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
                        <rect x="11" y="3" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
                        <rect x="3" y="11" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
                        <rect x="11" y="11" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                    <span>Dashboard</span>
                </a>

                <a href="destinations.html" class="nav-item">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M10 2C10 2 4 6 4 11C4 14.3137 6.68629 17 10 17C13.3137 17 16 14.3137 16 11C16 6 10 2 10 2Z" stroke="currentColor" stroke-width="1.5"/>
                        <circle cx="10" cy="11" r="2" fill="currentColor"/>
                    </svg>
                    <span>Destinations</span>
                </a>

                <a href="leads.html" class="nav-item">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M10 11C12.2091 11 14 9.20914 14 7C14 4.79086 12.2091 3 10 3C7.79086 3 6 4.79086 6 7C6 9.20914 7.79086 11 10 11Z" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M2 17C2 14 6 12 10 12C14 12 18 14 18 17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span>Leads & Contacts</span>
                </a>

                <a href="liv-settings.html" class="nav-item">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <circle cx="10" cy="10" r="3" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M10 1V4M10 16V19M19 10H16M4 10H1M16.95 16.95L14.83 14.83M5.17 5.17L3.05 3.05M16.95 3.05L14.83 5.17M5.17 14.83L3.05 16.95" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span>LIV AI Settings</span>
                </a>

                <a href="posts.html" class="nav-item">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M3 4H17M3 8H17M3 12H17M3 16H11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span>Blog Posts</span>
                </a>

                <a href="stories.html" class="nav-item">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <rect x="3" y="3" width="14" height="14" rx="2" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M7 7H13M7 11H13M7 14H10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span>Stories</span>
                </a>

                <a href="media.html" class="nav-item active">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <rect x="3" y="3" width="14" height="14" rx="2" stroke="currentColor" stroke-width="1.5"/>
                        <circle cx="7.5" cy="7.5" r="1.5" fill="currentColor"/>
                        <path d="M17 13L13 9L8 14M8 14L6 12L3 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>Media Library</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <div class="user-info">
                    <div class="user-avatar">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <circle cx="10" cy="7" r="3" stroke="currentColor" stroke-width="1.5"/>
                            <path d="M4 17C4 14 6 12 10 12C14 12 16 14 16 17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <div class="user-details">
                        <div class="user-name">Admin</div>
                        <div class="user-email" id="userEmail">Loading...</div>
                    </div>
                </div>
                <button id="logoutBtn" class="logout-btn" title="Logout">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M13 13L17 10L13 7M17 10H7M7 3H5C3.89543 3 3 3.89543 3 5V15C3 16.1046 3.89543 17 5 17H7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="content-header">
                <div class="header-left">
                    <h1>Media Library</h1>
                    <p class="subtitle">Manage images and files for your content</p>
                </div>
                <div class="header-right">
                    <a href="/" class="btn-secondary" target="_blank">
                        <svg width="18" height="18" viewBox="0 0 20 20" fill="none">
                            <path d="M10 3L3 8V17H7V12H13V17H17V8L10 3Z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                        </svg>
                        View Site
                    </a>
                </div>
            </header>

            <!-- Setup Banner (shown when configuration is needed) -->
            <div id="setupBanner" class="setup-banner">
                <div class="setup-banner-header">
                    <div class="setup-banner-icon">‚öôÔ∏è</div>
                    <div class="setup-banner-title">
                        <h3>Media Storage Setup Required</h3>
                        <p>Complete the setup steps below to enable image uploads</p>
                    </div>
                </div>

                <div class="setup-checklist">
                    <!-- Storage Bucket Check -->
                    <div class="setup-item" id="setupBucket">
                        <div class="setup-item-status checking">‚è≥</div>
                        <div class="setup-item-content">
                            <div class="setup-item-title">Media Storage Bucket</div>
                            <div class="setup-item-description">Checking if media storage bucket exists...</div>
                        </div>
                    </div>

                    <!-- Database Table Check -->
                    <div class="setup-item" id="setupTable">
                        <div class="setup-item-status checking">‚è≥</div>
                        <div class="setup-item-content">
                            <div class="setup-item-title">Media Database Table</div>
                            <div class="setup-item-description">Checking if media table exists...</div>
                        </div>
                    </div>
                </div>

                <button class="btn-refresh-check" onclick="MediaLibrary.recheckSetup()">
                    üîÑ Re-check Setup
                </button>
            </div>

            <!-- Upload Section -->
            <section class="upload-section" id="uploadSection">
                <div class="upload-zone" id="uploadZone">
                    <div class="upload-icon">üìÅ</div>
                    <h3>Drag & drop images here</h3>
                    <p>or</p>
                    <button class="btn-primary" type="button" onclick="document.getElementById('fileInput').click()">
                        Choose Files
                    </button>
                    <input type="file" id="fileInput" multiple accept="image/*" hidden>
                    <p class="upload-hint">Maximum 10MB per file ‚Ä¢ JPG, PNG, WEBP, GIF</p>
                </div>

                <div id="uploadProgress" class="upload-progress">
                    <!-- Upload progress items will be inserted here -->
                </div>
            </section>

            <!-- Toolbar -->
            <div class="media-toolbar">
                <div class="media-toolbar-left">
                    <div class="search-wrapper">
                        <input
                            type="text"
                            id="searchInput"
                            class="search-input"
                            placeholder="Search by filename..."
                        >
                    </div>
                </div>
                <div class="media-toolbar-right">
                    <div class="media-count">
                        <strong id="mediaCount">0</strong> files
                    </div>
                    <select id="sortSelect" class="sort-select">
                        <option value="date-desc">Newest first</option>
                        <option value="date-asc">Oldest first</option>
                        <option value="name-asc">Name (A-Z)</option>
                        <option value="name-desc">Name (Z-A)</option>
                        <option value="size-desc">Largest first</option>
                        <option value="size-asc">Smallest first</option>
                    </select>
                </div>
            </div>

            <!-- Media Grid -->
            <div id="mediaGrid" class="media-grid">
                <!-- Loading state -->
                <div class="media-loading">
                    <div class="loading-spinner"></div>
                </div>
            </div>

            <!-- Empty State (hidden by default) -->
            <div id="emptyState" class="empty-state" style="display: none;">
                <div class="empty-state-icon">üì∑</div>
                <h3>No media files yet</h3>
                <p>Upload your first image to get started</p>
                <button class="btn-primary" onclick="document.getElementById('fileInput').click()">
                    Upload Images
                </button>
            </div>
        </main>
    </div>

    <!-- Preview Modal -->
    <div id="previewModal" class="preview-modal">
        <div class="preview-content">
            <div class="preview-header">
                <h2>Image Details</h2>
                <button class="preview-close" onclick="MediaLibrary.closePreview()">√ó</button>
            </div>
            <div class="preview-body">
                <div class="preview-image-container">
                    <img id="previewImage" class="preview-image" src="" alt="">
                </div>

                <div class="preview-details">
                    <div class="preview-detail">
                        <div class="preview-label">Filename</div>
                        <div class="preview-value" id="previewFilename">-</div>
                    </div>
                    <div class="preview-detail">
                        <div class="preview-label">File Size</div>
                        <div class="preview-value" id="previewSize">-</div>
                    </div>
                    <div class="preview-detail">
                        <div class="preview-label">Dimensions</div>
                        <div class="preview-value" id="previewDimensions">-</div>
                    </div>
                    <div class="preview-detail">
                        <div class="preview-label">Upload Date</div>
                        <div class="preview-value" id="previewDate">-</div>
                    </div>
                    <div class="preview-detail full-width">
                        <div class="preview-label">Image URL</div>
                        <div class="preview-value">
                            <div class="url-display" id="previewUrl">-</div>
                            <button class="copy-url-btn" onclick="MediaLibrary.copyUrl()">
                                <span>üîó</span>
                                Copy URL
                            </button>
                        </div>
                    </div>
                </div>

                <div class="preview-edit-fields">
                    <div class="edit-field">
                        <label for="editAltText">Alt Text</label>
                        <input type="text" id="editAltText" placeholder="Describe the image for accessibility...">
                    </div>
                    <div class="edit-field">
                        <label for="editCaption">Caption</label>
                        <textarea id="editCaption" placeholder="Optional caption for the image..."></textarea>
                    </div>
                </div>
            </div>
            <div class="preview-footer">
                <button class="btn-danger" onclick="MediaLibrary.deleteCurrentImage()">
                    Delete Image
                </button>
                <button class="btn-primary" onclick="MediaLibrary.saveImageMetadata()">
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../supabase-client.js"></script>
    <script src="auth.js"></script>
    <script src="media.js"></script>

    <!-- Auth Protection -->
    <script>
        // Require authentication before loading media library
        (async function() {
            const user = await window.AuthManager.requireAuth();

            if (user) {
                // User is authenticated, update UI with user info
                await window.AuthManager.updateUserInfoUI();

                // Initialize media library
                await MediaLibrary.init();
            }
        })();
    </script>
</body>
</html>
